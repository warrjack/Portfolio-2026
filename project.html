<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Project â€” Portfolio</title>
    <meta name="description" content="Project details.">
    
    <link rel="icon" type="image/png" href="img/jw.jpg">

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;700&display=swap" rel="stylesheet">

    <!-- Tailwind CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
      :root { color-scheme: dark; }
      body { font-family: "Space Grotesk", ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, sans-serif; }
      html { scroll-behavior: smooth; }
      ::-webkit-scrollbar { width: 8px; }
      ::-webkit-scrollbar-thumb { background: #27272a; border-radius: 999px; }

      /* Gradient background */
      .bg-gradient-radial {
        background: radial-gradient(circle at 50% 0%, rgba(244, 191, 128, 0.08) 0%, transparent 50%),
                    radial-gradient(circle at 80% 20%, rgba(59, 130, 246, 0.05) 0%, transparent 50%);
      }

      /* Animated gradient border */
      @keyframes gradient-rotate {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
      }

      .gradient-border {
        position: relative;
        background: linear-gradient(135deg, #0b0d10, #111318);
      }

      .gradient-border::before {
        content: '';
        position: absolute;
        inset: 0;
        border-radius: inherit;
        padding: 1px;
        background: linear-gradient(135deg, rgba(244, 191, 128, 0.3), rgba(59, 130, 246, 0.3), rgba(244, 191, 128, 0.3));
        background-size: 200% 200%;
        -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
        -webkit-mask-composite: xor;
        mask-composite: exclude;
        animation: gradient-rotate 3s linear infinite;
      }

      /* Fade in animation */
      .fade-in {
        animation: fadeIn 0.6s ease-out forwards;
        opacity: 0;
      }

      @keyframes fadeIn {
        to { opacity: 1; }
      }

      .fade-in-up {
        animation: fadeInUp 0.8s ease-out forwards;
        opacity: 0;
      }

      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* Stagger delays */
      .delay-100 { animation-delay: 100ms; }
      .delay-200 { animation-delay: 200ms; }
      .delay-300 { animation-delay: 300ms; }
      .delay-400 { animation-delay: 400ms; }

      /* Tech badge hover effect */
      .tech-badge {
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
      }

      .tech-badge::before {
        content: '';
        position: absolute;
        inset: 0;
        background: linear-gradient(135deg, rgba(244, 191, 128, 0.1), rgba(59, 130, 246, 0.1));
        opacity: 0;
        transition: opacity 0.3s ease;
      }

      .tech-badge:hover {
        transform: translateY(-2px);
        border-color: rgba(244, 191, 128, 0.4);
      }

      .tech-badge:hover::before {
        opacity: 1;
      }

      /* Image overlay on hover */
      .image-overlay {
        position: absolute;
        inset: 0;
        background: linear-gradient(180deg, transparent 0%, rgba(11, 13, 16, 0.8) 100%);
        opacity: 0;
        transition: opacity 0.3s ease;
      }

      .carousel-slide:hover .image-overlay {
        opacity: 1;
      }

      /* Stat card pulse */
      @keyframes pulse-subtle {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.8; }
      }

      .stat-icon {
        animation: pulse-subtle 2s ease-in-out infinite;
      }

      .indent-icon {
        background: #444444;
        animation: indentMove 3s ease-in-out infinite;
      }

      /* Lightbox */
      .lightbox-overlay {
        position: fixed;
        inset: 0;
        z-index: 100;
        background: rgba(0, 0, 0, 0.92);
        display: flex;
        align-items: center;
        justify-content: center;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.3s ease;
        cursor: zoom-out;
      }

      .lightbox-overlay.active {
        opacity: 1;
        pointer-events: auto;
      }

      .lightbox-overlay img {
        max-width: 90vw;
        max-height: 90vh;
        object-fit: contain;
        border-radius: 12px;
        box-shadow: 0 25px 80px rgba(0, 0, 0, 0.6);
        transform: scale(0.9);
        transition: transform 0.3s ease;
      }

      .lightbox-overlay.active img {
        transform: scale(1);
      }

      .lightbox-close {
        position: absolute;
        top: 1.5rem;
        right: 1.5rem;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.15);
        backdrop-filter: blur(8px);
        border-radius: 50%;
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .lightbox-close:hover {
        background: rgba(255, 255, 255, 0.2);
        transform: scale(1.1);
      }

      .lightbox-nav {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.15);
        backdrop-filter: blur(8px);
        border-radius: 50%;
        width: 48px;
        height: 48px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .lightbox-nav:hover {
        background: rgba(255, 255, 255, 0.2);
        transform: translateY(-50%) scale(1.1);
      }

      .lightbox-nav.prev { left: 1.5rem; }
      .lightbox-nav.next { right: 1.5rem; }

      .lightbox-counter {
        position: absolute;
        bottom: 1.5rem;
        left: 50%;
        transform: translateX(-50%);
        background: rgba(0, 0, 0, 0.6);
        backdrop-filter: blur(8px);
        border-radius: 9999px;
        padding: 0.375rem 1rem;
        font-size: 0.8rem;
        color: rgba(255, 255, 255, 0.7);
      }
    </style>
  </head>
  <body class="bg-[#0b0d10] text-slate-200 selection:bg-[#F4BF80]/20 antialiased overflow-x-hidden">
    <!-- Accessibility: skip link -->
    <a class="sr-only focus:not-sr-only absolute left-4 top-4 rounded px-2 py-1 bg-black/60 text-white text-sm z-50" href="#main-content">Skip to content</a>

    <!-- Gradient background overlay -->
    <div class="fixed inset-0 bg-gradient-radial pointer-events-none"></div>

    <!-- Main Content -->
    <main id="main-content" class="relative min-h-screen w-full overflow-y-auto transition-opacity duration-300">
      <!-- Enhanced Header -->
      <div class="sticky top-0 z-30 border-b border-white/5 bg-[#0b0d10]/80 backdrop-blur-xl">
        <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
          <div class="flex h-16 items-center justify-between">
            <a href="portfolio.html" class="group flex items-center gap-2 text-sm font-medium text-slate-400 hover:text-white transition-all duration-300">
              <i data-lucide="arrow-left" class="h-4 w-4 transition-transform group-hover:-translate-x-1"></i>
              Back to Portfolio
            </a>
            <div class="flex items-center gap-4">
              <button id="share-btn" class="group flex items-center gap-2 text-sm font-medium text-slate-400 hover:text-white transition-colors">
                <i data-lucide="share-2" class="h-4 w-4"></i>
                <span class="hidden sm:inline">Share</span>
              </button>
            </div>
          </div>
        </div>
      </div>

      <div class="mx-auto max-w-7xl px-4 py-8 sm:py-12 sm:px-6 lg:px-8">
        <!-- Hero Section with Title -->
        <div class="mb-12 fade-in-up">
          <div class="flex flex-col gap-4 mb-6">
            <div class="flex items-center gap-3">
              <div class="h-1 w-12 indent-icon rounded-full"></div>
              <span id="modal-category" class="text-sm font-medium text-[#F4BF80] uppercase tracking-wider">Project</span>
            </div>
            <h1 id="modal-title" class="text-4xl sm:text-5xl lg:text-6xl font-bold text-white tracking-tight leading-tight"></h1>
            <p id="modal-subtitle" class="text-xl sm:text-2xl text-slate-400 max-w-3xl"></p>
          </div>

          <!-- Quick Stats -->
          <div class="grid grid-cols-2 sm:grid-cols-4 gap-4 mt-8 fade-in-up delay-100">
            <div class="gradient-border rounded-xl p-4 backdrop-blur-sm">
              <div class="flex items-center gap-3">
                <div class="p-2 rounded-lg bg-[#F4BF80]/10 stat-icon">
                  <i data-lucide="calendar" class="h-5 w-5 text-[#F4BF80]"></i>
                </div>
                <div>
                  <div class="text-xs text-slate-500 uppercase tracking-wider">Started</div>
                  <div id="stat-started" class="text-sm font-semibold text-white mt-0.5"></div>
                </div>
              </div>
            </div>
            <div class="gradient-border rounded-xl p-4 backdrop-blur-sm">
              <div class="flex items-center gap-3">
                <div class="p-2 rounded-lg bg-blue-500/10 stat-icon">
                  <i data-lucide="clock" class="h-5 w-5 text-blue-400"></i>
                </div>
                <div>
                  <div class="text-xs text-slate-500 uppercase tracking-wider">Updated</div>
                  <div id="stat-updated" class="text-sm font-semibold text-white mt-0.5"></div>
                </div>
              </div>
            </div>
            <div class="gradient-border rounded-xl p-4 backdrop-blur-sm">
              <div class="flex items-center gap-3">
                <div class="p-2 rounded-lg bg-purple-500/10 stat-icon">
                  <i data-lucide="code" class="h-5 w-5 text-purple-400"></i>
                </div>
                <div>
                  <div class="text-xs text-slate-500 uppercase tracking-wider">Role</div>
                  <div class="text-sm font-semibold text-white mt-0.5">Sole Dev</div>
                </div>
              </div>
            </div>
            <div class="gradient-border rounded-xl p-4 backdrop-blur-sm">
              <div class="flex items-center gap-3">
                <div class="p-2 rounded-lg bg-green-500/10 stat-icon">
                  <i data-lucide="layers" class="h-5 w-5 text-green-400"></i>
                </div>
                <div>
                  <div class="text-xs text-slate-500 uppercase tracking-wider">Stack</div>
                  <div id="stat-stack-count" class="text-sm font-semibold text-white mt-0.5">0</div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="grid lg:grid-cols-3 gap-8">
          <!-- Left Column: Carousel + Description -->
          <div class="lg:col-span-2 space-y-8">
            <!-- Enhanced Carousel -->
            <div class="relative aspect-video w-full overflow-hidden rounded-2xl bg-zinc-900 border border-white/10 group shadow-2xl fade-in-up delay-200">
              <!-- Slider Track -->
              <div id="modal-carousel-track" class="flex h-full w-full transition-transform duration-500 ease-out">
                <!-- Images injected via JS -->
              </div>

              <!-- Image counter -->
              <div class="absolute top-4 right-4 rounded-full bg-black/60 backdrop-blur-md px-3 py-1.5 text-xs font-medium text-white z-20 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                <span id="slide-counter">1</span> / <span id="slide-total">1</span>
              </div>

              <!-- Carousel Controls -->
              <button onclick="prevSlide()" class="absolute left-4 top-1/2 -translate-y-1/2 rounded-full bg-black/50 p-3 text-white opacity-100 lg:opacity-0 backdrop-blur hover:bg-black/70 hover:scale-110 group-hover:opacity-100 transition-all duration-300 z-10">
                <i data-lucide="chevron-left" class="h-5 w-5"></i>
              </button>
              <button onclick="nextSlide()" class="absolute right-4 top-1/2 -translate-y-1/2 rounded-full bg-black/50 p-3 text-white opacity-100 lg:opacity-0 backdrop-blur hover:bg-black/70 hover:scale-110 group-hover:opacity-100 transition-all duration-300 z-10">
                <i data-lucide="chevron-right" class="h-5 w-5"></i>
              </button>

              <!-- Enhanced Dots -->
              <div id="modal-carousel-dots" class="absolute bottom-4 left-1/2 flex -translate-x-1/2 gap-2 z-10">
                <!-- Dots injected via JS -->
              </div>
            </div>

            <!-- Description Section -->
            <div class="gradient-border rounded-2xl p-6 sm:p-8 backdrop-blur-sm fade-in-up delay-300">
              <div class="flex items-center gap-3 mb-4">
                <div class="h-8 w-1 indent-icon rounded-full"></div>
                <h2 class="text-2xl font-bold text-white">About This Project</h2>
              </div>
              <div class="prose prose-invert prose-slate max-w-none">
                <div id="modal-description" class="text-slate-300 leading-relaxed text-base sm:text-lg"></div>
              </div>
            </div>

            <!-- Key Features Section -->
            <div class="gradient-border rounded-2xl p-6 sm:p-8 backdrop-blur-sm fade-in-up delay-400">
              <div class="flex items-center gap-3 mb-6">
                <div class="h-8 w-1 indent-icon rounded-full"></div>
                <h2 class="text-2xl font-bold text-white">Key Highlights</h2>
              </div>
              <div id="features-grid" class="grid sm:grid-cols-2 gap-4">
                <!-- Features will be injected here -->
                <div class="flex items-start gap-3 p-4 rounded-xl bg-white/5 border border-white/10 hover:border-[#F4BF80]/30 transition-all duration-300">
                  <div class="p-2 rounded-lg bg-[#F4BF80]/10 mt-0.5">
                    <i data-lucide="zap" class="h-4 w-4 text-[#F4BF80]"></i>
                  </div>
                  <div>
                    <h3 class="font-semibold text-white text-sm mb-1">Performance Optimized</h3>
                    <p class="text-xs text-slate-400">Built for speed and efficiency</p>
                  </div>
                </div>
                <div class="flex items-start gap-3 p-4 rounded-xl bg-white/5 border border-white/10 hover:border-blue-400/30 transition-all duration-300">
                  <div class="p-2 rounded-lg bg-blue-500/10 mt-0.5">
                    <i data-lucide="smartphone" class="h-4 w-4 text-blue-400"></i>
                  </div>
                  <div>
                    <h3 class="font-semibold text-white text-sm mb-1">Responsive Design</h3>
                    <p class="text-xs text-slate-400">Works seamlessly across devices</p>
                  </div>
                </div>
                <div class="flex items-start gap-3 p-4 rounded-xl bg-white/5 border border-white/10 hover:border-purple-400/30 transition-all duration-300">
                  <div class="p-2 rounded-lg bg-purple-500/10 mt-0.5">
                    <i data-lucide="shield-check" class="h-4 w-4 text-purple-400"></i>
                  </div>
                  <div>
                    <h3 class="font-semibold text-white text-sm mb-1">Secure & Reliable</h3>
                    <p class="text-xs text-slate-400">Industry-standard security practices</p>
                  </div>
                </div>
                <div class="flex items-start gap-3 p-4 rounded-xl bg-white/5 border border-white/10 hover:border-green-400/30 transition-all duration-300">
                  <div class="p-2 rounded-lg bg-green-500/10 mt-0.5">
                    <i data-lucide="users" class="h-4 w-4 text-green-400"></i>
                  </div>
                  <div>
                    <h3 class="font-semibold text-white text-sm mb-1">User-Centric</h3>
                    <p class="text-xs text-slate-400">Designed with users in mind</p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Right Sidebar: Tech Stack & Info -->
          <div class="space-y-6">
            <!-- Tech Stack -->
            <div class="gradient-border rounded-2xl p-6 backdrop-blur-sm sticky top-24 fade-in-up delay-300">
              <div class="flex items-center gap-3 mb-4">
                <div class="p-2 rounded-lg bg-[#F4BF80]/10">
                  <i data-lucide="box" class="h-5 w-5 text-[#F4BF80]"></i>
                </div>
                <h3 class="text-lg font-bold text-white">Technology Stack</h3>
              </div>
              <div id="modal-stack" class="flex flex-wrap gap-2"></div>
            </div>

            <!-- Project Links (optional) -->
            <div id="quick-links-container" class="gradient-border rounded-2xl p-6 backdrop-blur-sm fade-in-up delay-400">
              <div class="flex items-center gap-3 mb-4">
                <div class="p-2 rounded-lg bg-blue-500/10">
                  <i data-lucide="link" class="h-5 w-5 text-blue-400"></i>
                </div>
                <h3 class="text-lg font-bold text-white">Quick Links</h3>
              </div>
              <div id="quick-links" class="space-y-3">
                <!-- Links will be injected via JS -->
              </div>
            </div>

            <!-- Additional Info Card -->
            <div class="gradient-border rounded-2xl p-6 backdrop-blur-sm fade-in-up delay-500">
              <div class="flex items-center gap-3 mb-4">
                <div class="p-2 rounded-lg bg-purple-500/10">
                  <i data-lucide="info" class="h-5 w-5 text-purple-400"></i>
                </div>
                <h3 class="text-lg font-bold text-white">Project Info</h3>
              </div>
              <dl class="space-y-4 text-sm">
                <div class="flex justify-between items-center pb-3 border-b border-white/5">
                  <dt class="text-slate-500 flex items-center gap-2">
                    <i data-lucide="briefcase" class="h-3.5 w-3.5"></i>
                    Type
                  </dt>
                  <dd class="text-slate-200 font-medium">Personal</dd>
                </div>
                <div class="flex justify-between items-center pb-3 border-b border-white/5">
                  <dt class="text-slate-500 flex items-center gap-2">
                    <i data-lucide="target" class="h-3.5 w-3.5"></i>
                    Status
                  </dt>
                  <dd class="text-slate-200 font-medium">
                    <span class="inline-flex items-center gap-1.5 px-2 py-1 rounded-full bg-green-500/10 text-green-400 text-xs">
                      <span class="h-1.5 w-1.5 rounded-full bg-green-400"></span>
                      Active
                    </span>
                  </dd>
                </div>
                <div class="flex justify-between items-center pt-1">
                  <dt class="text-slate-500 flex items-center gap-2">
                    <i data-lucide="git-branch" class="h-3.5 w-3.5"></i>
                    Version
                  </dt>
                  <dd id="stat-version" class="text-slate-200 font-medium"></dd>
                </div>
              </dl>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- Lightbox Modal -->
    <div id="lightbox" class="lightbox-overlay" onclick="closeLightbox(event)">
      <button class="lightbox-close" onclick="closeLightbox(event)" aria-label="Close">
        <i data-lucide="x" class="h-5 w-5"></i>
      </button>
      <button class="lightbox-nav prev" onclick="lightboxPrev(event)" aria-label="Previous image">
        <i data-lucide="chevron-left" class="h-6 w-6"></i>
      </button>
      <img id="lightbox-img" src="" alt="Full size image" />
      <button class="lightbox-nav next" onclick="lightboxNext(event)" aria-label="Next image">
        <i data-lucide="chevron-right" class="h-6 w-6"></i>
      </button>
      <div class="lightbox-counter">
        <span id="lightbox-counter-current">1</span> / <span id="lightbox-counter-total">1</span>
      </div>
    </div>

    <script>
      lucide.createIcons();

      // Carousel state
      let currentSlide = 0;
      let totalSlides = 0;
      let lightboxImages = [];
      let lightboxIndex = 0;

      function updateCarousel() {
        const track = document.getElementById('modal-carousel-track');
        track.style.transform = `translateX(-${currentSlide * 100}%)`;

        const dots = document.getElementById('modal-carousel-dots').children;
        Array.from(dots).forEach((dot, idx) => {
          if (idx === currentSlide) {
            dot.classList.remove('bg-white/30', 'w-1.5');
            dot.classList.add('bg-white', 'w-8');
          } else {
            dot.classList.add('bg-white/30', 'w-1.5');
            dot.classList.remove('bg-white', 'w-8');
          }
        });

        // Update counter
        document.getElementById('slide-counter').textContent = currentSlide + 1;
      }

      function nextSlide() {
        currentSlide = (currentSlide + 1) % totalSlides;
        updateCarousel();
      }

      function prevSlide() {
        currentSlide = (currentSlide - 1 + totalSlides) % totalSlides;
        updateCarousel();
      }
      

      // Share button functionality
      document.getElementById('share-btn').addEventListener('click', async () => {
        if (navigator.share) {
          try {
            await navigator.share({
              title: document.getElementById('modal-title').textContent,
              text: document.getElementById('modal-subtitle').textContent,
              url: window.location.href
            });
          } catch (err) {
            console.log('Share cancelled');
          }
        } else {
          // Fallback: copy to clipboard
          navigator.clipboard.writeText(window.location.href);
          alert('Link copied to clipboard!');
        }
      });

      // Get project ID from URL
      const params = new URLSearchParams(window.location.search);
      const projectId = parseInt(params.get('id')) || 0;

      async function fetchProjectData() {
        // Fetch main projects from JSON
        const res = await fetch('data/projects.json');
        const mainProjects = await res.json();
        let project;
        if (projectId < mainProjects.length) {
          project = mainProjects[projectId];
        } else {
          // Dynamically import generateProjectData
          try {
            const module = await import('data/generateProjectData.js');
            project = module.generateProjectData(projectId);
          } catch (e) {
            project = {
              title: 'Unknown Project',
              subtitle: '',
              desc: 'No data found.',
              stack: [],
              started: '',
              updated: '',
              images: []
            };
          }
        }
        return project;
      }

      window.addEventListener('load', async () => {
        const project = await fetchProjectData();
        
        fetch('https://post-server-xcsn.onrender.com/load',{ method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ page: project.title })});
        document.getElementById('modal-title').textContent = project.title;
        document.getElementById('modal-subtitle').textContent = project.subtitle;

        // Render description with preserved paragraphs/line-breaks.
        function escapeHTML(str) {
          return String(str)
            .replace(/&/g, '&amp;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;')
            .replace(/\"/g, '&quot;')
            .replace(/'/g, '&#39;');
        }

        function renderDescription(desc) {
          const el = document.getElementById('modal-description');
          if (!desc) { el.innerHTML = ''; return; }
          // Split on double newlines to create proper paragraph breaks with spacing
          const escaped = escapeHTML(desc);
          const paragraphs = escaped.split(/\n\n+/).map(p => p.trim()).filter(Boolean);
          el.innerHTML = paragraphs.map(p => `<p class="mb-4 last:mb-0">${p}</p>`).join('');
        }

        renderDescription(project.desc || '');

        document.getElementById('stat-started').textContent = project.started;
        document.getElementById('stat-updated').textContent = project.updated;
        document.getElementById('stat-version').textContent = project.project_info.version || '0.1.0';

        // Populate carousel
        const track = document.getElementById('modal-carousel-track');
        const dotsContainer = document.getElementById('modal-carousel-dots');
        track.innerHTML = '';
        dotsContainer.innerHTML = '';

        const imagesList = project.images || [];
        totalSlides = imagesList.length;
        currentSlide = 0;

        document.getElementById('slide-total').textContent = totalSlides;

        imagesList.forEach((src, idx) => {
          const slide = document.createElement('div');
          slide.className = "flex-none w-full h-full carousel-slide relative";
          slide.innerHTML = `
            <img src="${src}" alt="${project.title} screenshot ${idx + 1}" loading="lazy" decoding="async" class="h-full w-full object-cover cursor-zoom-in" onclick="openLightbox(${idx})" />
            <div class="image-overlay pointer-events-none"></div>
          `;
          lightboxImages.push(src);
          track.appendChild(slide);

          const dot = document.createElement('div');
          dot.className = "h-1.5 rounded-full transition-all duration-300 bg-white/30 cursor-pointer hover:bg-white/50";
          dot.style.width = idx === 0 ? '2rem' : '0.375rem';
          dot.addEventListener('click', () => {
            currentSlide = idx;
            updateCarousel();
          });
          dotsContainer.appendChild(dot);
        });

        updateCarousel();

        // Populate stack
        const stackContainer = document.getElementById('modal-stack');
        stackContainer.innerHTML = '';
        const stack = project.stack || [];
        document.getElementById('stat-stack-count').textContent = stack.length;

        stack.forEach(tech => {
          const s = document.createElement('span');
          s.className = "tech-badge rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-xs font-medium text-slate-300";
          s.textContent = tech;
          stackContainer.appendChild(s);
        });

        // Populate Quick Links
        const quickLinksContainer = document.getElementById('quick-links');
        const quickLinksSection = document.getElementById('quick-links-container');
        quickLinksContainer.innerHTML = '';

        const liveDemo = project.live_demo;
        const github = project.github;

        // Helper function to create a "Coming Soon" badge
        function createComingSoonBadge(label) {
          const div = document.createElement('div');
          div.className = "flex items-center justify-between p-3 rounded-xl bg-white/5 border border-white/10 opacity-60 cursor-not-allowed";
          div.innerHTML = `
            <span class="text-sm text-slate-400">${label}</span>
            <span class="text-xs text-slate-500 px-2 py-1 rounded-full bg-white/5">Coming Soon</span>
          `;
          return div;
        }

        // Helper function to create a link button
        function createLinkButton(href, label, iconName, hoverColor) {
          const a = document.createElement('a');
          a.href = href;
          a.target = "_blank";
          a.rel = "noopener noreferrer";
          a.className = `flex items-center justify-between p-3 rounded-xl bg-white/5 border border-white/10 hover:border-${hoverColor}/30 hover:bg-white/10 transition-all duration-300 group`;
          a.innerHTML = `
            <span class="text-sm text-slate-300 group-hover:text-white transition-colors">${label}</span>
            <i data-lucide="${iconName}" class="h-4 w-4 text-slate-400 group-hover:text-${hoverColor} transition-colors"></i>
          `;
          return a;
        }

        let hasLinks = false;

        // Live Demo link
        if (liveDemo === "Coming Soon") {
          quickLinksContainer.appendChild(createComingSoonBadge("Live Demo"));
          hasLinks = true;
        } else if (liveDemo && liveDemo !== null) {
          quickLinksContainer.appendChild(createLinkButton(liveDemo, "View Live Demo", "external-link", "[#F4BF80]"));
          hasLinks = true;
        }

        // GitHub link
        if (github === "Coming Soon") {
          quickLinksContainer.appendChild(createComingSoonBadge("Repository"));
          hasLinks = true;
        } else if (github && github !== null) {
          quickLinksContainer.appendChild(createLinkButton(github, "View Repository", "github", "blue-400"));
          hasLinks = true;
        }

        // Hide Quick Links section if no links available
        if (!hasLinks) {
          quickLinksSection.style.display = 'none';
        }

        lucide.createIcons();
      });

      // Lightbox functions
      function openLightbox(index) {
        lightboxIndex = index;
        const lightbox = document.getElementById('lightbox');
        const img = document.getElementById('lightbox-img');
        img.src = lightboxImages[lightboxIndex];
        document.getElementById('lightbox-counter-current').textContent = lightboxIndex + 1;
        document.getElementById('lightbox-counter-total').textContent = lightboxImages.length;
        lightbox.classList.add('active');
        document.body.style.overflow = 'hidden';
      }

      function closeLightbox(e) {
        if (e.target.closest('.lightbox-nav')) return;
        document.getElementById('lightbox').classList.remove('active');
        document.body.style.overflow = '';
      }

      function lightboxPrev(e) {
        e.stopPropagation();
        lightboxIndex = (lightboxIndex - 1 + lightboxImages.length) % lightboxImages.length;
        const img = document.getElementById('lightbox-img');
        img.src = lightboxImages[lightboxIndex];
        document.getElementById('lightbox-counter-current').textContent = lightboxIndex + 1;
      }

      function lightboxNext(e) {
        e.stopPropagation();
        lightboxIndex = (lightboxIndex + 1) % lightboxImages.length;
        const img = document.getElementById('lightbox-img');
        img.src = lightboxImages[lightboxIndex];
        document.getElementById('lightbox-counter-current').textContent = lightboxIndex + 1;
      }

      // Keyboard navigation for carousel and lightbox
      document.addEventListener('keydown', (e) => {
        const lightbox = document.getElementById('lightbox');
        if (lightbox.classList.contains('active')) {
          if (e.key === 'ArrowLeft') lightboxPrev(e);
          if (e.key === 'ArrowRight') lightboxNext(e);
          if (e.key === 'Escape') { lightbox.classList.remove('active'); document.body.style.overflow = ''; }
        } else {
          if (e.key === 'ArrowLeft') prevSlide();
          if (e.key === 'ArrowRight') nextSlide();
        }
      });
    </script>
  </body>
</html>
